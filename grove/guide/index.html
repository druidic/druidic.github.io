<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Grove User Guide</title>
  </head>
  <body>
<pre><code>
## API Reference

### The Data Recorder

The **Data Recorder** holds *records*, which may be
documents, programs, or any other data. A record has a
*name*, which must be unique among all records in the
system. It also has *content*.

Data written to the recorder will persist across
restarts of the computer.

Most of the time, the programs you use will
interact with the data recorder on your behalf. However,
you can also write records directly by
clicking the small button on the right side of
the computer's case. This is the only way to install an
operating system on a Grove computer that doesn't yet have
one.

### Starting up

When a Grove system starts up, it looks for a record called
`startup`. It expects this record to contain the
definition of a function `main()`. If the `main()`
function exists, the Grove
will run it. If not, it will display an error message to
explain what went wrong.

Here is an example `startup` record:

```javascript
function main() {
  return 'Hello, world!'
}
```

This is not a very interesting program. It will cause the
Grove to display just the text `Hello, world!`. It
will not react to any input; the text will just remain on
the screen forever. Kind of pointless, but it does
illustrate the fact that whatever text is returned from
`main()` will be displayed on the screen.

Let's write a more interesting program. Here is one that
counts the number of keys the user has pressed since the
computer started up.

```javascript
var count = 0
function main(event) {
  if (event.type === 'keyDown') {
    count++
  }
  return 'Keys pressed: ' + count
}
```

What's going on here? The key to understanding this is that
`main` is called more than once. In fact, `main` is called
every time the Grove detects an *event* in the system.
An event can be any of the following:

- a keypress or key release
- a file change
- a web request returning some data or failing
- an animation timer ticking ahead to a new frame

The `main` function also receives the current state of the
data storage system as its second argument.

Here is an example of a program that reads from data storage
to print its own source code.

```javascript
function main(event, data) {
  return data.read('startup').split('\n')
}
```
</code></pre>
  </body>
</html>
